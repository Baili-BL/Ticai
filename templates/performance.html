<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>收益统计 - 题材雷达</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'PingFang SC', sans-serif; 
            background: #0d1117; 
            min-height: 100vh; 
            color: #e6edf3;
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .icon {
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        .icon-sm { width: 14px; height: 14px; }
        .icon-lg { width: 20px; height: 20px; }
        
        /* 顶部导航 */
        .navbar {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(13, 17, 23, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.08);
            padding: 12px 16px;
        }
        
        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, #58a6ff, #a371f7);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logo .icon { stroke: #58a6ff; width: 20px; height: 20px; }
        
        .nav-actions { display: flex; gap: 8px; align-items: center; }
        
        .nav-link {
            color: #8b949e;
            text-decoration: none;
            font-size: 13px;
            padding: 6px 10px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .nav-link.active {
            background: rgba(88, 166, 255, 0.15);
            color: #58a6ff;
        }
        
        /* 控制栏 */
        .controls {
            display: flex;
            gap: 8px;
            padding: 12px 16px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .controls::-webkit-scrollbar { display: none; }
        
        .ctrl-btn {
            flex-shrink: 0;
            padding: 8px 14px;
            background: rgba(255,255,255,0.05);
            color: #8b949e;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .ctrl-btn:active { background: rgba(255,255,255,0.1); }
        
        .ctrl-btn.primary {
            background: linear-gradient(135deg, #238636, #2ea043);
            color: #fff;
            border: none;
        }
        
        /* 主内容 */
        .container { padding: 12px; }
        
        .loading { text-align: center; padding: 60px 20px; color: #8b949e; }
        .error { text-align: center; padding: 40px; color: #f85149; }
        .empty { text-align: center; padding: 40px; color: #8b949e; font-size: 14px; }
        
        /* 概览卡片 */
        .overview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 16px;
        }
        
        .stat-card {
            background: #161b22;
            border-radius: 12px;
            padding: 14px;
            border: 1px solid rgba(255,255,255,0.08);
            text-align: center;
        }
        
        .stat-label {
            font-size: 11px;
            color: #8b949e;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        
        .stat-value {
            font-size: 22px;
            font-weight: 700;
        }
        
        .stat-value.up { color: #f85149; }
        .stat-value.down { color: #3fb950; }
        .stat-value.neutral { color: #58a6ff; }
        
        .stat-sub {
            font-size: 10px;
            color: #8b949e;
            margin-top: 4px;
        }
        
        .stat-sub.warn { color: #f85149; }
        
        /* 区块 */
        .section {
            background: #161b22;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(255,255,255,0.08);
            overflow: hidden;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #58a6ff;
            padding: 12px 14px;
            background: rgba(88, 166, 255, 0.08);
            border-bottom: 1px solid rgba(255,255,255,0.05);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .section-body { padding: 10px; }
        
        /* 策略网格 */
        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .strategy-card {
            background: rgba(255,255,255,0.02);
            border-radius: 10px;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .strategy-card h4 {
            font-size: 13px;
            color: #a371f7;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* 表格 */
        .data-table { width: 100%; font-size: 12px; }
        .data-table th { text-align: left; padding: 6px 4px; color: #8b949e; font-weight: normal; }
        .data-table td { padding: 6px 4px; }
        
        .up { color: #f85149; }
        .down { color: #3fb950; }
        
        /* 标签 */
        .role-tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 700;
        }
        
        .role-leader { background: linear-gradient(135deg, #f85149, #da3633); color: #fff; }
        .role-middle { background: linear-gradient(135deg, #58a6ff, #388bfd); color: #fff; }
        .role-dip { background: linear-gradient(135deg, #3fb950, #2ea043); color: #fff; }
        .role-other { background: rgba(255,255,255,0.1); color: #8b949e; }
        
        .score-label {
            display: inline-block;
            padding: 2px 6px;
            background: rgba(88, 166, 255, 0.15);
            color: #58a6ff;
            border-radius: 4px;
            font-size: 10px;
        }
        
        .tag-highlight {
            display: inline-block;
            padding: 2px 6px;
            background: rgba(248, 81, 73, 0.2);
            color: #f85149;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }
        
        /* 股票列表 */
        .stock-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
            margin-bottom: 6px;
        }
        
        .stock-list-item:last-child { margin-bottom: 0; }
        
        .stock-list-left {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            min-width: 0;
        }
        
        .stock-list-name {
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .stock-list-code {
            font-size: 11px;
            color: #8b949e;
        }
        
        .stock-list-meta {
            font-size: 11px;
            color: #8b949e;
        }
        
        .stock-list-return {
            font-size: 15px;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        /* 买不到列表 */
        .unbuyable-reason {
            font-size: 11px;
            color: #f85149;
            display: flex;
            align-items: center;
            gap: 3px;
        }
    </style>
</head>
<body>
    <!-- SVG图标定义 -->
    <svg style="display:none">
        <defs>
            <symbol id="icon-trending-up" viewBox="0 0 24 24">
                <path d="M23 6l-9.5 9.5-5-5L1 18M17 6h6v6"/>
            </symbol>
            <symbol id="icon-chart" viewBox="0 0 24 24">
                <path d="M3 3v18h18M9 17V9m4 8v-5m4 5V6"/>
            </symbol>
            <symbol id="icon-list" viewBox="0 0 24 24">
                <path d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"/>
            </symbol>
            <symbol id="icon-refresh" viewBox="0 0 24 24">
                <path d="M23 4v6h-6M1 20v-6h6"/>
                <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
            </symbol>
            <symbol id="icon-calendar" viewBox="0 0 24 24">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <path d="M16 2v4M8 2v4M3 10h18"/>
            </symbol>
            <symbol id="icon-tag" viewBox="0 0 24 24">
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/>
                <circle cx="7" cy="7" r="1" fill="currentColor"/>
            </symbol>
            <symbol id="icon-star" viewBox="0 0 24 24">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </symbol>
            <symbol id="icon-repeat" viewBox="0 0 24 24">
                <path d="M17 1l4 4-4 4"/>
                <path d="M3 11V9a4 4 0 014-4h14"/>
                <path d="M7 23l-4-4 4-4"/>
                <path d="M21 13v2a4 4 0 01-4 4H3"/>
            </symbol>
            <symbol id="icon-zap" viewBox="0 0 24 24">
                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </symbol>
            <symbol id="icon-bar-chart" viewBox="0 0 24 24">
                <path d="M12 20V10M18 20V4M6 20v-4"/>
            </symbol>
            <symbol id="icon-activity" viewBox="0 0 24 24">
                <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
            </symbol>
            <symbol id="icon-award" viewBox="0 0 24 24">
                <circle cx="12" cy="8" r="7"/>
                <path d="M8.21 13.89L7 23l5-3 5 3-1.21-9.12"/>
            </symbol>
            <symbol id="icon-alert-triangle" viewBox="0 0 24 24">
                <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                <path d="M12 9v4M12 17h.01"/>
            </symbol>
            <symbol id="icon-ban" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <path d="M4.93 4.93l14.14 14.14"/>
            </symbol>
        </defs>
    </svg>

    <nav class="navbar">
        <div class="navbar-content">
            <div class="logo">
                <svg class="icon"><use href="#icon-trending-up"/></svg>
                收益统计
            </div>
            <div class="nav-actions">
                <a href="/" class="nav-link">
                    <svg class="icon icon-sm"><use href="#icon-chart"/></svg>
                    推荐
                </a>
                <a href="/history" class="nav-link">
                    <svg class="icon icon-sm"><use href="#icon-list"/></svg>
                    历史
                </a>
                <a href="/performance" class="nav-link active">
                    <svg class="icon icon-sm"><use href="#icon-trending-up"/></svg>
                    收益
                </a>
            </div>
        </div>
    </nav>
    
    <div class="controls">
        <button class="ctrl-btn" onclick="loadData(7)">7天</button>
        <button class="ctrl-btn" onclick="loadData(15)">15天</button>
        <button class="ctrl-btn" onclick="loadData(30)">30天</button>
        <button class="ctrl-btn primary" onclick="updatePerformance()">
            <svg class="icon icon-sm"><use href="#icon-refresh"/></svg>
            更新收益
        </button>
    </div>
    
    <div class="container">
        <div id="content" class="loading">加载中...</div>
    </div>

    <script>
        let currentDays = 30;
        
        async function loadData(days = 30) {
            currentDays = days;
            const content = document.getElementById('content');
            content.innerHTML = '<div class="loading">加载中...</div>';
            
            try {
                const res = await fetch('/api/performance/summary?days=' + days);
                const json = await res.json();
                if (!json.success) throw new Error(json.error);
                renderData(json.data);
            } catch (e) {
                content.innerHTML = '<div class="error">' + e.message + '</div>';
            }
        }
        
        function renderData(data) {
            if (!data || data.total_stocks === 0) {
                document.getElementById('content').innerHTML = `
                    <div class="empty">
                        暂无收益数据<br>
                        <small style="color:#8b949e">请先刷新推荐页面生成报表<br>然后点击"更新收益"</small>
                    </div>`;
                return;
            }
            
            let html = '';
            
            // 概览卡片
            const winClass = data.win_rate >= 50 ? 'up' : 'down';
            const avgClass = data.avg_return >= 0 ? 'up' : 'down';
            const buyableCount = data.buyable_stocks || data.total_stocks;
            const unbuyableCount = data.unbuyable_stocks || 0;
            
            html += `
            <div class="overview">
                <div class="stat-card">
                    <div class="stat-label"><svg class="icon icon-sm"><use href="#icon-bar-chart"/></svg> 可买入</div>
                    <div class="stat-value neutral">${buyableCount}</div>
                    <div class="stat-sub">共${data.total_stocks}只</div>
                    ${unbuyableCount > 0 ? `<div class="stat-sub warn">${unbuyableCount}只买不到</div>` : ''}
                </div>
                <div class="stat-card">
                    <div class="stat-label"><svg class="icon icon-sm"><use href="#icon-activity"/></svg> T+1胜率</div>
                    <div class="stat-value ${winClass}">${data.win_rate}%</div>
                    <div class="stat-sub">盈利${data.win_count}只</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label"><svg class="icon icon-sm"><use href="#icon-trending-up"/></svg> T+1收益</div>
                    <div class="stat-value ${avgClass}">${data.avg_return >= 0 ? '+' : ''}${data.avg_return}%</div>
                    <div class="stat-sub">平均</div>
                </div>
            </div>`;
            
            // 按持有天数统计
            if (data.by_days && Object.keys(data.by_days).length > 0) {
                html += `<div class="section">
                    <div class="section-title"><svg class="icon"><use href="#icon-calendar"/></svg> 不同持有期</div>
                    <div class="section-body">
                        <table class="data-table">
                            <thead><tr><th>持有期</th><th>样本</th><th>收益</th><th>胜率</th></tr></thead>
                            <tbody>`;
                
                for (const [period, stats] of Object.entries(data.by_days)) {
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    html += `<tr>
                        <td><strong>${period}</strong></td>
                        <td>${stats.count}</td>
                        <td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td>
                        <td>${stats.win_rate}%</td>
                    </tr>`;
                }
                html += '</tbody></table></div></div>';
            }
            
            // 策略分类统计
            html += `<div class="section"><div class="section-title"><svg class="icon"><use href="#icon-chart"/></svg> 策略分类收益（T+1）</div><div class="section-body"><div class="strategy-grid">`;
            
            // 按角色
            if (data.by_role && Object.keys(data.by_role).length > 0) {
                html += `<div class="strategy-card"><h4><svg class="icon icon-sm"><use href="#icon-tag"/></svg> 按角色</h4><table class="data-table">
                    <thead><tr><th>角色</th><th>收益</th><th>胜率</th></tr></thead><tbody>`;
                const roleOrder = ['龙头', '中军', '低吸', '跟风'];
                for (const role of roleOrder) {
                    const stats = data.by_role[role];
                    if (!stats) continue;
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    let roleTag = '';
                    if (role === '龙头') roleTag = '<span class="role-tag role-leader">龙头</span>';
                    else if (role === '中军') roleTag = '<span class="role-tag role-middle">中军</span>';
                    else if (role === '低吸') roleTag = '<span class="role-tag role-dip">低吸</span>';
                    else roleTag = '<span class="role-tag role-other">跟风</span>';
                    html += `<tr><td>${roleTag}</td><td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td><td>${stats.win_rate}%</td></tr>`;
                }
                html += '</tbody></table></div>';
            }
            
            // 按评分
            if (data.by_score && Object.keys(data.by_score).length > 0) {
                html += `<div class="strategy-card"><h4><svg class="icon icon-sm"><use href="#icon-star"/></svg> 按评分</h4><table class="data-table">
                    <thead><tr><th>评分</th><th>收益</th><th>胜率</th></tr></thead><tbody>`;
                const scoreOrder = ['90+强推', '80-89可买', '70-79观察', '<70弱'];
                for (const label of scoreOrder) {
                    const stats = data.by_score[label];
                    if (!stats) continue;
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    html += `<tr><td><span class="score-label">${label}</span></td><td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td><td>${stats.win_rate}%</td></tr>`;
                }
                html += '</tbody></table></div>';
            }
            
            // 弱转强
            if (data.by_weak_to_strong && Object.keys(data.by_weak_to_strong).length > 0) {
                html += `<div class="strategy-card"><h4><svg class="icon icon-sm"><use href="#icon-repeat"/></svg> 弱转强</h4><table class="data-table">
                    <thead><tr><th>类型</th><th>收益</th><th>胜率</th></tr></thead><tbody>`;
                for (const [label, stats] of Object.entries(data.by_weak_to_strong)) {
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    const tagClass = label === '弱转强' ? 'tag-highlight' : '';
                    html += `<tr><td><span class="${tagClass}">${label}</span></td><td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td><td>${stats.win_rate}%</td></tr>`;
                }
                html += '</tbody></table></div>';
            }
            
            // 前排强度
            if (data.by_front_runner && Object.keys(data.by_front_runner).length > 0) {
                html += `<div class="strategy-card"><h4><svg class="icon icon-sm"><use href="#icon-zap"/></svg> 前排强度</h4><table class="data-table">
                    <thead><tr><th>类型</th><th>收益</th><th>胜率</th></tr></thead><tbody>`;
                for (const [label, stats] of Object.entries(data.by_front_runner)) {
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    const tagClass = label === '前排强势' ? 'tag-highlight' : '';
                    html += `<tr><td><span class="${tagClass}">${label}</span></td><td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td><td>${stats.win_rate}%</td></tr>`;
                }
                html += '</tbody></table></div>';
            }
            
            // 按量能
            if (data.by_volume && Object.keys(data.by_volume).length > 0) {
                html += `<div class="strategy-card"><h4><svg class="icon icon-sm"><use href="#icon-bar-chart"/></svg> 按量能</h4><table class="data-table">
                    <thead><tr><th>量能</th><th>收益</th><th>胜率</th></tr></thead><tbody>`;
                const volumeOrder = ['爆量', '放量', '中量', '缩量', '地量'];
                for (const label of volumeOrder) {
                    const stats = data.by_volume[label];
                    if (!stats) continue;
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    html += `<tr><td>${label}</td><td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td><td>${stats.win_rate}%</td></tr>`;
                }
                html += '</tbody></table></div>';
            }
            
            // 按强度
            if (data.by_strength && Object.keys(data.by_strength).length > 0) {
                html += `<div class="strategy-card"><h4><svg class="icon icon-sm"><use href="#icon-activity"/></svg> 按强度</h4><table class="data-table">
                    <thead><tr><th>强度</th><th>收益</th><th>胜率</th></tr></thead><tbody>`;
                const strengthOrder = ['涨停', '强势', '偏强', '震荡', '偏弱', '弱势'];
                for (const label of strengthOrder) {
                    const stats = data.by_strength[label];
                    if (!stats) continue;
                    const avgClass = stats.avg_return >= 0 ? 'up' : 'down';
                    html += `<tr><td>${label}</td><td class="${avgClass}">${stats.avg_return >= 0 ? '+' : ''}${stats.avg_return}%</td><td>${stats.win_rate}%</td></tr>`;
                }
                html += '</tbody></table></div>';
            }
            
            html += '</div></div></div>';
            
            // 最佳表现
            if (data.best_stocks && data.best_stocks.length > 0) {
                html += `<div class="section"><div class="section-title"><svg class="icon"><use href="#icon-award"/></svg> 最佳表现（T+1）</div><div class="section-body">`;
                for (const s of data.best_stocks) {
                    let roleTag = '';
                    if (s.role === '龙头') roleTag = '<span class="role-tag role-leader">龙头</span>';
                    else if (s.role === '中军') roleTag = '<span class="role-tag role-middle">中军</span>';
                    else if (s.role === '低吸') roleTag = '<span class="role-tag role-dip">低吸</span>';
                    html += `<div class="stock-list-item">
                        <div class="stock-list-left">
                            ${roleTag}
                            <span class="stock-list-name">${s.name}</span>
                            <span class="stock-list-code">${s.code}</span>
                        </div>
                        <div class="stock-list-return up">+${s.return_pct}%</div>
                    </div>`;
                }
                html += '</div></div>';
            }
            
            // 最差表现
            if (data.worst_stocks && data.worst_stocks.length > 0) {
                html += `<div class="section"><div class="section-title"><svg class="icon"><use href="#icon-alert-triangle"/></svg> 最差表现（T+1）</div><div class="section-body">`;
                for (const s of data.worst_stocks) {
                    let roleTag = '';
                    if (s.role === '龙头') roleTag = '<span class="role-tag role-leader">龙头</span>';
                    else if (s.role === '中军') roleTag = '<span class="role-tag role-middle">中军</span>';
                    else if (s.role === '低吸') roleTag = '<span class="role-tag role-dip">低吸</span>';
                    const retClass = s.return_pct >= 0 ? 'up' : 'down';
                    html += `<div class="stock-list-item">
                        <div class="stock-list-left">
                            ${roleTag}
                            <span class="stock-list-name">${s.name}</span>
                            <span class="stock-list-code">${s.code}</span>
                        </div>
                        <div class="stock-list-return ${retClass}">${s.return_pct >= 0 ? '+' : ''}${s.return_pct}%</div>
                    </div>`;
                }
                html += '</div></div>';
            }
            
            // 买不到的股票
            if (data.unbuyable_list && data.unbuyable_list.length > 0) {
                html += `<div class="section"><div class="section-title"><svg class="icon"><use href="#icon-ban"/></svg> 买不到的股票</div><div class="section-body">
                    <div style="font-size:12px;color:#8b949e;margin-bottom:10px">已排除统计</div>`;
                for (const s of data.unbuyable_list) {
                    html += `<div class="stock-list-item">
                        <div class="stock-list-left">
                            <span class="stock-list-name">${s.name}</span>
                            <span class="stock-list-code">${s.code}</span>
                            <span class="stock-list-meta">${s.theme}</span>
                        </div>
                        <div class="unbuyable-reason"><svg class="icon icon-sm"><use href="#icon-ban"/></svg> ${s.reason || '一字涨停'}</div>
                    </div>`;
                }
                html += '</div></div>';
            }
            
            document.getElementById('content').innerHTML = html;
        }
        
        async function updatePerformance() {
            const btn = event.target.closest('.ctrl-btn');
            btn.disabled = true;
            btn.innerHTML = '<svg class="icon icon-sm"><use href="#icon-refresh"/></svg> 更新中...';
            
            try {
                const res = await fetch('/api/performance/update', { method: 'POST' });
                const json = await res.json();
                if (!json.success) throw new Error(json.error);
                alert('收益更新完成！');
                loadData(currentDays);
            } catch (e) {
                alert('更新失败: ' + e.message);
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<svg class="icon icon-sm"><use href="#icon-refresh"/></svg> 更新收益';
            }
        }
        
        loadData(30);
    </script>
</body>
</html>
